alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Cknife Shell Command Struct Inbound (PHP)"; flow:to_server,established; content:"POST"; http_method; content:"User-Agent|3a 20|Java"; http_header; depth:16; content:"=@eval"; http_client_body; depth:9; content:"base64_decode"; http_client_body; distance:0; content:"&action="; http_client_body; distance:0; content:!"Referer|3a 20|"; http_header; reference:url,recordedfuture.com/web-shell-analysis-part-2; classtype:trojan-activity; sid:2022976; rev:2; metadata:attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2016_07_20, performance_impact Low, updated_at 2016_07_20;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Cknife Shell Command Struct Inbound (aspx)"; flow:to_server,established; content:"POST"; http_method; content:"User-Agent|3a 20|Java"; http_header; depth:16; content:"=Response.Write"; http_client_body; depth:18; fast_pattern; content:"eval"; http_client_body; distance:0; content:!"Referer|3a 20|"; http_header; reference:url,www.recordedfuture.com/web-shell-analysis-part-2; classtype:trojan-activity; sid:2022977; rev:2; metadata:attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2016_07_20, performance_impact Low, updated_at 2016_07_20;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Weevely PHP backdoor detected (system() function used)"; flow:to_server,established; content:"QHN5c3Rl"; http_header; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013937; rev:6; metadata:created_at 2011_11_21, updated_at 2011_11_21;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Weevely PHP backdoor detected (passthru() function used)"; flow:to_server,established; content:"cGFzc3Ro"; http_header;  reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013938; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Weevely PHP backdoor detected (shell_exec() function used)"; flow:to_server,established; content:"aGVsbF9l"; http_header;  reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013939; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Weevely PHP backdoor detected (proc_open() function used)"; flow:to_server,established; content:"JHAgPSBhcnJheShhcnJh"; http_header;  reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013940; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Weevely PHP backdoor detected (popen() function used)"; flow:to_server,established; content:"JGggPSBwb3Bl"; http_header;  reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013941; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Weevely PHP backdoor detected (python_eval() function used)"; flow:to_server,established; content:"QHB5dGhvbl9l"; http_header; metadata: former_category WEB_SERVER; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013942; rev:5; metadata:created_at 2011_11_21, updated_at 2017_03_21;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Weevely PHP backdoor detected (pcntl_exec() function used)"; flow:to_server,established; content:"JGFyZ3MgPSBh"; http_header; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013943; rev:6; metadata:created_at 2011_11_21, updated_at 2011_11_21;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Weevely PHP backdoor detected (perl->system() function used)"; flow:to_server,established; content:"JHBlcmwgPSBuZXcg"; http_header;  reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013944; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Weevely PHP backdoor detected (exec() function used)"; flow:to_server,established; content:"ZXhlYygn"; http_header;  reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:2013945; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"TROJAN WEB_SHELL Image Content-Type with Obfuscated PHP (Seen with C99 Shell)"; flow:from_server,established; content:"Content-Type|3a| image/"; http_header; file_data; content:"eval(gzinflate(base64_decode("; distance:0; fast_pattern; reference:url,malwaremustdie.blogspot.jp/2012/10/how-far-phpc99shell-malware-can-go-from.html; classtype:attempted-user; sid:2015755; rev:3; metadata:created_at 2012_10_02, updated_at 2012_10_02;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL FaTaLisTiCz_Fx Webshell Detected"; flow:established,from_server; content:"visitz="; http_cookie; file_data; content:"FaTaLisTiCz_Fx"; classtype:web-application-activity; sid:2015811; rev:2; metadata:created_at 2012_10_18, updated_at 2012_10_18;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - D.K - Title"; flow:established,to_client; file_data; content:"<title>"; content:" - D.K "; fast_pattern; distance:0; content:"</title>"; distance:0; classtype:bad-unknown; sid:2015917; rev:2; metadata:created_at 2012_11_21, updated_at 2012_11_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - Generic - c99shell based header"; flow:established,to_client; file_data; content:"<span>Uname<br>User<br>Php<br>Hdd<br>Cwd</span>"; classtype:attempted-user; sid:2015918; rev:2; metadata:created_at 2012_11_21, updated_at 2012_11_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - Generic - c99shell based header w/colons"; flow:established,to_client; file_data; content:"<span>Uname|3a|<br>User|3a|<br>Php|3a|<br>Hdd|3a|<br>Cwd|3a|</span>"; classtype:attempted-user; sid:2015919; rev:3; metadata:created_at 2012_11_21, updated_at 2012_11_21;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"TROJAN WEB_SHELL - Generic - c99shell based POST structure w/multipart"; flow:established,to_server; content:"POST"; http_method; content:"form-data\; name=|22|a|22|"; http_client_body; content:"form-data\; name=|22|c|22|"; http_client_body; content:"form-data\; name=|22|p1|22|"; http_client_body; classtype:attempted-user; sid:2015920; rev:2; metadata:created_at 2012_11_21, updated_at 2012_11_21;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"TROJAN WEB_SHELL - PHP eMailer"; flow:established,to_server; content:"POST"; http_method; content:"form-data|3b| name=|22|from|22|"; http_client_body; content:"form-data|3b| name=|22|realname|22|"; http_client_body; content:"form-data|3b| name=|22|amount|22|"; http_client_body; classtype:web-application-activity; sid:2015924; rev:2; metadata:created_at 2012_11_23, updated_at 2012_11_23;)

#alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - Unknown - self-kill"; flow:established,to_client; file_data; content:"<a href=|22|?x=selfremove|22|>[Self-Kill]</a>"; classtype:web-application-activity; sid:2015925; rev:2; metadata:created_at 2012_11_23, updated_at 2012_11_23;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"TROJAN WEB_SHELL - Unknown - .php?x=img&img="; flow:established,to_server; content:".php?x=img&img="; http_uri; fast_pattern:only; classtype:web-application-activity; sid:2015926; rev:2; metadata:created_at 2012_11_23, updated_at 2012_11_23;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"TROJAN WEB_SHELL - PostMan"; flow:established,to_server; content:"POST"; http_method; content:"form-data|3b| name=|22|formSubmited|22|"; http_client_body; content:"form-data|3b| name=|22|scriptPassword|22|"; http_client_body; classtype:misc-activity; sid:2015937; rev:7; metadata:created_at 2012_11_26, updated_at 2012_11_26;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - JSP RAT"; flow:established,to_client; file_data; content:"<table id=\"filetable\" class=\"filelist\" cellspacing=\"1px\" cellpadding=\"0px\">"; classtype:attempted-user; sid:2016151; rev:3; metadata:created_at 2013_01_04, updated_at 2013_01_04;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - JSP File Admin"; flow:established,to_client; file_data; content:"<h2>(L)aunch external program</h2>"; classtype:attempted-user; sid:2016152; rev:4; metadata:created_at 2013_01_04, updated_at 2013_01_04;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - JSP File Admin - POST Structure - dir"; flow:established,to_server; content:"POST"; http_method; content:"dir="; http_client_body; content:"&sort="; http_client_body; content:"&command="; http_client_body; content:"&Submit="; http_client_body; classtype:attempted-user; sid:2016153; rev:3; metadata:created_at 2013_01_04, updated_at 2013_01_04;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - Symlink_Sa"; flow:established,to_client; file_data; content:"<title>Symlink_Sa"; classtype:bad-unknown; sid:2016244; rev:2; metadata:created_at 2013_01_21, updated_at 2013_01_21;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - Generic - c99shell based header"; flow:established,to_client; file_data; content:"<b>Software|3a|"; content:"<b>uname -a|3a|"; content:"<b>uid="; classtype:bad-unknown; sid:2016245; rev:3; metadata:created_at 2013_01_21, updated_at 2013_01_21;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - zecmd - Form"; flow:established,to_client; file_data; content:"<FORM METHOD=|22|GET|22| NAME=|22|comments|22| ACTION=|22 22|>"; classtype:attempted-user; sid:2016501; rev:2; metadata:created_at 2013_02_25, updated_at 2013_02_25;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"TROJAN WEB_SHELL - Generic - c99shell based POST structure"; flow:established,to_server; content:"POST"; http_method; content:"act="; depth:4; fast_pattern; http_client_body; content:"&d="; http_client_body; within:20; classtype:attempted-user; sid:2016516; rev:2; metadata:created_at 2013_03_04, updated_at 2013_03_04;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - MySQL Interface - Database List"; flow:established,to_client; file_data; content:"<h1>Databases List</h1>"; classtype:bad-unknown; sid:2016574; rev:2; metadata:created_at 2013_03_13, updated_at 2013_03_13;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - MySQL Interface - Client Cookie mysql_web_admin*="; flow:established,to_server; content:"mysql_web_admin_"; http_cookie; classtype:bad-unknown; sid:2016575; rev:3; metadata:created_at 2013_03_13, updated_at 2013_03_13;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - MySQL Interface - Server Set Cookie mysql_web_admin*="; flow:established,to_client; content:"mysql_web_admin_"; http_cookie; classtype:bad-unknown; sid:2016576; rev:2; metadata:created_at 2013_03_13, updated_at 2013_03_13;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - Romanian Webshell"; flow:established,to_client; file_data; content:"Incarca fisier|3a|"; content:"Exeuta comada|3a|"; classtype:bad-unknown; sid:2016577; rev:4; metadata:created_at 2013_03_13, updated_at 2013_03_13;)

alert http $HTTP_SERVERS any -> $HOME_NET any (msg:"TROJAN WEB_SHELL - Simple - Title"; flow:established,to_client; file_data; content:"- Simple Shell</title>"; classtype:bad-unknown; sid:2016679; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic - net user"; flow:established,to_server; content:"POST"; http_method; content:"net"; nocase; http_client_body; content:!"work"; within:4; nocase; http_client_body; content:"user"; nocase; within:11; http_client_body; content:!"-agent"; nocase; http_client_body; within:6; pcre:"/net(?:%(?:25)?20|\s)+user/Pi"; classtype:bad-unknown; sid:2016680; rev:6; metadata:created_at 2013_03_27, updated_at 2013_03_27;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic - netsh firewall"; flow:established,to_server; content:"netsh"; nocase; fast_pattern; http_client_body; content:"firewall"; within:15; http_client_body; classtype:bad-unknown; sid:2016681; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic - reg HKEY_LOCAL_MACHINE"; flow:established,to_server; content:"reg"; nocase; http_client_body; content:"HKEY_LOCAL_MACHINE"; nocase; within:80; http_client_body; classtype:bad-unknown; sid:2016682; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic - wget http - POST"; flow:established,to_server; content:"wget"; nocase; http_client_body; content:"http"; nocase; http_client_body; within:11; classtype:bad-unknown; sid:2016683; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - JSPCMD - Form"; flow:established,to_client; file_data; content:"<FORM METHOD=\"GET\" NAME=\"comments\" ACTION=\"\">"; classtype:bad-unknown; sid:2016684; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - MySQL Interface - Auth Prompt"; flow:established,to_client; file_data; content:"bG9nb25fc3VibWl0"; classtype:bad-unknown; sid:2016689; rev:2; metadata:created_at 2013_04_01, updated_at 2013_04_01;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - PHPShell - Comment"; flow:established,to_client; file_data; content:"<!-- PHPShell "; classtype:attempted-user; sid:2016760; rev:2; metadata:created_at 2013_04_16, updated_at 2013_04_16;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - PHPShell - Haxplorer URI"; flow:established,to_server; content:".php?&s=r&cmd=dir&dir="; http_uri; classtype:attempted-user; sid:2016761; rev:2; metadata:created_at 2013_04_16, updated_at 2013_04_16;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - PHPShell - PHPKonsole URI"; flow:established,to_server; content:".php?&s=r&cmd=con"; http_uri; classtype:attempted-user; sid:2016762; rev:2; metadata:created_at 2013_04_16, updated_at 2013_04_16;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic - *.tar.gz in POST body"; flow:established,to_server; content:".tar.gz"; nocase; http_client_body; classtype:bad-unknown; sid:2016992; rev:2; metadata:created_at 2013_06_07, updated_at 2013_06_07;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic - ELF File Uploaded"; flow:established,to_server; content:"|7F|ELF"; http_client_body; classtype:bad-unknown; sid:2017054; rev:2; metadata:created_at 2013_06_21, updated_at 2013_06_21;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - GODSpy - GOD Hacker"; flow:established,to_client; file_data; content:"GOD Hacker"; classtype:trojan-activity; sid:2017083; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - GODSpy - GODSpy title"; flow:established,to_client; file_data; content:"GODSpy</title>"; classtype:trojan-activity; sid:2017084; rev:3; metadata:created_at 2013_07_02, updated_at 2013_07_02;)

alert http any any -> any any (msg:"TROJAN WEB_SHELL - GODSpy - Cookie"; flow:established; content:"godid="; http_cookie; classtype:trojan-activity; sid:2017085; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - GODSpy - MySQL"; flow:established,to_server; content:"dbhost="; http_client_body; content:"dbuser="; http_client_body; content:"dbpass="; classtype:trojan-activity; sid:2017086; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - GODSpy - Auth Prompt"; flow:established,to_client; file_data; content:"name=|22|haz|22| value=|22|pasa|22|>"; classtype:trojan-activity; sid:2017087; rev:3; metadata:created_at 2013_07_02, updated_at 2013_07_02;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - GODSPy - Auth Creds"; flow:established,to_server; content:"ctr="; http_client_body; content:"haz=pasa"; http_client_body; classtype:trojan-activity; sid:2017088; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - Pouya - Pouya_Server Shell"; flow:established,to_client; file_data; content:"Pouya_Server Shell"; classtype:trojan-activity; sid:2017089; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - Pouya - URI - raiz"; flow:established,to_server; content:".asp?raiz="; http_uri; classtype:trojan-activity; sid:2017090; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - Pouya - URI - action="; flow:established,to_server; content:".asp?action="; http_uri; nocase; fast_pattern:only; pcre:"/\.asp\?action=(?:txt(?:edit|view)|upload|info|del)(&|$)/Ui"; classtype:trojan-activity; sid:2017091; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02;)

alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - Generic - GIF Header With HTML Form"; flow:established,to_client; file_data; content:"GIF89a"; within:6; content:"<form "; nocase; fast_pattern; within:150; classtype:trojan-activity; sid:2017134; rev:4; metadata:created_at 2013_07_11, updated_at 2013_07_11;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL ASPXShell - Title"; flow:established,to_client; file_data; content:"<title>"; content:"ASPX Shell"; fast_pattern; nocase;  content:"</title>"; distance:0; classtype:trojan-activity; sid:2017183; rev:4; metadata:created_at 2013_07_24, updated_at 2013_07_24;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic - ASP File Uploaded"; flow:established,to_server; content:"|0D 0A|"; http_client_body; content:"<%"; within:5; http_client_body; fast_pattern; content:"%>"; http_client_body; distance:0; pcre:"/<%[\x00-\x7f]{20}/P"; classtype:trojan-activity; sid:2017260; rev:11; metadata:created_at 2013_07_31, updated_at 2013_07_31;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - ASPyder - Auth Creds"; flow:established,to_server; content:!"&date="; http_client_body; content:"code="; http_client_body; depth:5; content:"&submit="; distance:0; http_client_body; classtype:trojan-activity; sid:2017389; rev:6; metadata:created_at 2013_08_28, updated_at 2013_08_28;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - ASPyder - File Browser - Interface"; flow:established,to_client; file_data; content:"document.myform.txtpath.value"; classtype:trojan-activity; sid:2017390; rev:3; metadata:created_at 2013_08_28, updated_at 2013_08_28;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - ASPyder - Auth Prompt"; flow:established,to_client; file_data; content:"<INPUT type=password name=code >"; classtype:trojan-activity; sid:2017391; rev:2; metadata:created_at 2013_08_28, updated_at 2013_08_28;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - ASPyder - File Browser - POST Structure"; flow:established,to_server; content:"POST"; http_method; nocase; content:"txtpath="; http_client_body; depth:8; content:"&cmd="; http_client_body; classtype:trojan-activity; sid:2017392; rev:2; metadata:created_at 2013_08_28, updated_at 2013_08_28;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - ASPyder -File Upload - POST Structure"; flow:established,to_server; content:"POST"; http_method; nocase; content:"?upload=@&txtpath="; http_uri; content:"Upload !"; http_client_body; classtype:trojan-activity; sid:2017393; rev:2; metadata:created_at 2013_08_28, updated_at 2013_08_28;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL - ASPyder - File Upload - Response"; flow:established,to_client; file_data; content:"<title>ASPYDrvsInfo</title>"; classtype:trojan-activity; sid:2017394; rev:2; metadata:created_at 2013_08_28, updated_at 2013_08_28;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic eval of base64_decode"; flow:established,from_server; file_data; content:"base64_decode"; nocase; fast_pattern:only; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?base64_decode/Rsi"; classtype:trojan-activity; sid:2017399; rev:7; metadata:created_at 2013_08_30, updated_at 2013_08_30;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic eval of gzinflate"; flow:established,from_server; file_data; content:"gzinflate"; nocase; fast_pattern:only; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?gzinflate/Rsi"; classtype:trojan-activity; sid:2017400; rev:7; metadata:created_at 2013_08_30, updated_at 2013_08_30;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic eval of str_rot13"; flow:established,from_server; file_data; content:"str_rot13"; nocase; fast_pattern:only; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?str_rot13/Rsi"; classtype:trojan-activity; sid:2017401; rev:7; metadata:created_at 2013_08_30, updated_at 2013_08_30;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic eval of gzuncompress"; flow:established,from_server; file_data; content:"gzuncompress"; nocase; fast_pattern:only; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?gzuncompress/Rsi"; classtype:trojan-activity; sid:2017402; rev:7; metadata:created_at 2013_08_30, updated_at 2013_08_30;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Generic eval of convert_uudecode"; flow:established,from_server; file_data; content:"convert_uudecode"; nocase; fast_pattern:only; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?convert_uudecode/Rsi"; classtype:trojan-activity; sid:2017403; rev:7; metadata:created_at 2013_08_30, updated_at 2013_08_30;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL PHP WebShell Embedded In GIF (OUTBOUND)"; flow:established,to_client; file_data; content:"GIF89"; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017604; rev:2; metadata:created_at 2013_10_17, updated_at 2013_10_17;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL PHP WebShell Embedded In JPG (OUTBOUND)"; flow:established,to_client; file_data; content:"JFIF|00|"; distance:6; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017605; rev:2; metadata:created_at 2013_10_17, updated_at 2013_10_17;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL PHP WebShell Embedded In PNG (OUTBOUND)"; flow:established,to_client; file_data; content:"PNG|0D 0A 1A 0A|"; distance:1; within:7; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017606; rev:2; metadata:created_at 2013_10_17, updated_at 2013_10_17;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL PHP WebShell Embedded In GIF (INBOUND)"; flow:established,from_server; file_data; content:"GIF89"; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017607; rev:2; metadata:created_at 2013_10_17, updated_at 2013_10_17;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL PHP WebShell Embedded In JPG (INBOUND)"; flow:established,from_server; file_data; content:"JFIF|00|"; distance:6; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017608; rev:2; metadata:created_at 2013_10_17, updated_at 2013_10_17;)

alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL PHP WebShell Embedded In PNG (INBOUND)"; flow:established,from_server; file_data; content:"PNG|0D 0A 1A 0A|"; distance:1; within:7; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:2017609; rev:3; metadata:created_at 2013_10_17, updated_at 2013_10_17;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Possible Encrypted Webshell Download"; flow:established,to_client; file_data; content:"eval"; content:"mcrypt_decrypt"; distance:0; within:30; reference:url,blog.sucuri.net/2013/10/backdoor-evasion-using-encrypted-content.html; classtype:bad-unknown; sid:2017640; rev:3; metadata:affected_product PHP, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2013_10_28, performance_impact Low, updated_at 2017_01_23;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Possible Encrypted Webshell in POST"; flow:established,to_server; content:"POST"; http_method; content:"eval"; http_client_body; content:"mcrypt_decrypt"; http_client_body; distance:0; reference:url,blog.sucuri.net/2013/10/backdoor-evasion-using-encrypted-content.html; classtype:bad-unknown; sid:2017641; rev:3; metadata:created_at 2013_10_28, updated_at 2013_10_28;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL pwn.jsp shell"; flow:established,to_server; content:"/pwn.jsp?"; http_uri; nocase; fast_pattern:only; content:"cmd="; http_uri; nocase; reference:url,nickhumphreyit.blogspot.co.il/2013/10/jboss-42-hacked-by-pwnjsp.html; reference:url,blog.imperva.com/2013/11/threat-advisory-a-jboss-as-exploit-web-shell-code-injection.html; classtype:attempted-admin; sid:2017734; rev:4; metadata:created_at 2013_11_19, updated_at 2013_11_19;)

alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL Perl/Mambo.WebShell Spreader IRC Scanning Message"; flow:established,to_server; content:"PRIVMSG|20|"; content:"Scanning"; fast_pattern; within:50; content:"for open ports."; within:40; classtype:trojan-activity; sid:2017828; rev:2; metadata:created_at 2013_12_09, updated_at 2013_12_09;)

alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL Perl/Mambo.WebShell Spreader IRC Open Ports Message"; flow:established,to_server; content:"PRIVMSG|20|"; content:"Open port(s)|3A| "; fast_pattern; within:50; classtype:trojan-activity; sid:2017829; rev:2; metadata:created_at 2013_12_09, updated_at 2013_12_09;)

alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL Perl/Mambo.WebShell Spreader IRC No Open Ports Message"; flow:established,to_server; content:"PRIVMSG|20|"; content:"No open ports found"; fast_pattern; within:50; classtype:trojan-activity; sid:2017830; rev:1; metadata:created_at 2013_12_09, updated_at 2013_12_09;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL ATTACKER WebShell - PHP Offender - Title"; flow:established,to_client; file_data; content:"<title>PHP Shell offender</title>"; nocase; classtype:web-application-attack; sid:2017951; rev:3; metadata:created_at 2014_01_10, updated_at 2014_01_10;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL ATTACKER WebShell - PHP Offender - POST Command"; flow:established,to_server; content:"work_dir="; http_client_body; content:"command="; http_client_body; content:"submit_btn=Execute+Command"; http_client_body; classtype:web-application-attack; sid:2017952; rev:2; metadata:created_at 2014_01_10, updated_at 2014_01_10;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL CFM Shell Access"; flow:established,from_server; file_data; content:"<title>CFM shell"; nocase; reference:url,blog.spiderlabs.com/2014/03/coldfusion-admin-compromise-analysis-cve-2010-2861.html; classtype:successful-admin; sid:2018290; rev:2; metadata:created_at 2014_03_18, updated_at 2014_03_18;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL K-Shell/ZHC Shell 1.0/Aspx Shell Backdoor NetCat_Listener"; flow:established,from_server; file_data; content:"Silentz's Tricks:"; content:"action=cmd2"; content:"Start NC"; reference:url,www.fidelissecurity.com/webfm_send/377; reference:url,pastebin.com/XAG1Hnfd; classtype:web-application-attack; sid:2018369; rev:2; metadata:created_at 2014_04_07, updated_at 2014_04_07;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL ATTACKER WebShell - Zehir4.asp"; flow:established,to_server; content:".asp?mevla=1"; http_uri; nocase; fast_pattern:only; reference:url,pastebin.com/m44e60e60; reference:url,www.fidelissecurity.com/webfm_send/377; classtype:web-application-attack; sid:2018370; rev:4; metadata:created_at 2014_04_07, updated_at 2014_04_07;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL ATTACKER WebShell - Zehir4.asp - content"; flow:established,from_server; file_data; content:"<title>zehir3--> powered by zehir"; content:"Sistem Bilgileri"; content:"color=red>Local Adres</td"; content:"zehirhacker"; reference:url,pastebin.com/m44e60e60; reference:url,www.fidelissecurity.com/webfm_send/377; classtype:web-application-attack; sid:2018371; rev:2; metadata:created_at 2014_04_07, updated_at 2014_04_07;)

alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL SUSPICIOUS Possible WebShell Login Form (Outbound)"; flow:established,from_server; file_data; content:"<pre align=center><form method=post>Password|3a| <input type=password name=pass><input type=submit value=|27|>>|27|></form></pre>"; within:120; isdataat:!2,relative; reference:url,blog.malwaremustdie.org/2014/05/elf-shared-so-dynamic-library-malware.html; classtype:trojan-activity; sid:2018459; rev:2; metadata:created_at 2014_05_09, updated_at 2014_05_09;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"TROJAN WEB_SHELL c99 Shell Backdoor Var Override URI"; flow:to_server,established; content:"c99shcook["; nocase; http_uri; fast_pattern:only; pcre:"/[&?]c99shcook\[/Ui"; reference:url,thehackerblog.com/every-c99-php-shell-is-backdoored-aka-free-shells/; classtype:trojan-activity; sid:2018601; rev:2; metadata:created_at 2014_06_24, updated_at 2014_06_24;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"TROJAN WEB_SHELL c99 Shell Backdoor Var Override Cookie"; flow:to_server,established; content:"c99shcook"; nocase; fast_pattern:only; pcre:"/c99shcook/Ci"; reference:url,thehackerblog.com/every-c99-php-shell-is-backdoored-aka-free-shells/; classtype:trojan-activity; sid:2018602; rev:2; metadata:created_at 2014_06_24, updated_at 2014_06_24;)

alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"TROJAN WEB_SHELL c99 Shell Backdoor Var Override Client Body"; flow:to_server,established; content:"c99shcook["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&)c99shcook\[/Pi"; reference:url,thehackerblog.com/every-c99-php-shell-is-backdoored-aka-free-shells/; classtype:trojan-activity; sid:2018603; rev:2; metadata:created_at 2014_06_24, updated_at 2014_06_24;)

alert http any any -> any any (msg:"TROJAN WEB_SHELL ATTACKER WebShell - 1337w0rm - Landing Page"; flow:established,to_client; file_data; content:"cPanel Cracker"; classtype:trojan-activity; sid:2020096; rev:3; metadata:created_at 2015_01_06, updated_at 2015_01_06;)

alert http any any -> any any (msg:"TROJAN WEB_SHELL ATTACKER WebShell - 1337w0rm - cPanel Cracker"; flow:established,to_server; content:"user=CRACKER"; http_client_body; classtype:trojan-activity; sid:2020097; rev:2; metadata:created_at 2015_01_06, updated_at 2015_01_06;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL ATTACKER WebShell - Weevely - Downloaded"; flow:established,to_client; file_data; content:"<?php|0A|$"; content:"="; distance:4; within:2; content:" str_replace("; distance:0; classtype:trojan-activity; sid:2020555; rev:2; metadata:created_at 2015_02_24, updated_at 2015_02_24;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL ATTACKER WebShell - Weevely - POSTed"; flow:established,to_server; content:"<?php|0A|$"; http_client_body; content:"="; distance:4; within:2; http_client_body; content:" str_replace("; distance:0; http_client_body; classtype:trojan-activity; sid:2020556; rev:2; metadata:created_at 2015_02_24, updated_at 2015_02_24;)

alert http any any -> $EXTERNAL_NET any (msg:"TROJAN WEB_SHELL ATTACKER WebShell - Weevely - Cookie"; flow:established,to_server; content:"ing|3a| identity|0D 0A|Host|3a|"; http_header; content:"SESS="; http_cookie; content:"|3B| SID="; distance:0; http_cookie; content:"|3B| PREF="; distance:0; http_cookie; content:"|3B|SSID="; distance:0; http_cookie; classtype:trojan-activity; sid:2020557; rev:2; metadata:created_at 2015_02_24, updated_at 2015_02_24;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL - ASPyder - File Create - POST Structure"; flow:established,to_server; content:"POST"; http_method; content:"Fname="; http_client_body; depth:6; content:"&cmd="; http_client_body; classtype:trojan-activity; sid:2020572; rev:3; metadata:created_at 2015_02_25, updated_at 2015_02_25;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL JSP/Backdoor Shell Access"; flow:established,to_server; content:".war?cmd="; http_uri; fast_pattern:only; content:"&winurl="; http_uri; content:"&linurl="; http_uri; pcre:"/\.war\?cmd=[a-zA-Z0-9+/=]+&winurl=[a-zA-Z0-9+/=]*&linurl=[a-zA-Z0-9+/=]*/U"; reference:url,blog.malwaremustdie.org/2016/01/mmd-0049-2016-case-of-java-trojan.html; classtype:successful-admin; sid:2022348; rev:3; metadata:created_at 2016_01_11, updated_at 2016_01_11;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Linux/Torte Uploaded"; flow:established,to_server; content:"POST"; http_method; content:"JGVudiA9ICJYRFZTTl9TRVNTSU9OX0NPT0tJR"; http_client_body; fast_pattern:only; content:"eval(base64_decode($_REQUEST["; http_client_body; reference:url,blog.malwaremustdie.org/2016/01/mmd-0050-2016-incident-report-elf.html; classtype:attempted-admin; sid:2022359; rev:2; metadata:created_at 2016_01_13, updated_at 2016_01_13;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL AnonGhost PHP Webshell"; flow:from_server,established; file_data; content:"base64_decode("; content:"Bbm9uR2hvc3Qg"; fast_pattern; classtype:trojan-activity; sid:2023143; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2016_09_01, performance_impact Low, updated_at 2016_09_01;)

alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL Suspected Detected WebShell Uploaded"; flow:established,to_server; content:"POST"; nocase; http_method; content:"@eval($_POST["; http_client_body; reference:url,www.fireeye.com/blog/technical/botnet-activities-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html; classtype:trojan-activity; sid:3040001; rev:1; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag BackDoor, tag signature_severity Major, created_at 2017_07_10, updated_at 2017_07_10;)

#alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"TROJAN WEB_SHELL used In timthumb attacks GIF98a 16129xX with PHP"; flow:to_client,established; file_data; content:"|0d 0a 0d 0a|GIF89a|01 3f|"; content:"<?"; within:720; reference:url,blog.sucuri.net/2012/05/list-of-domains-hosting-webshells-for-timthumb-attacks.html; classtype:web-application-attack; sid:2014848; rev:3; metadata:created_at 2012_06_01, updated_at 2012_06_01;)

